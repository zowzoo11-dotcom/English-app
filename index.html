<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>English Level Up ‚Äî 7-Day + Vocab Journal</title>
  <meta name="theme-color" content="#151935" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icon-192.png" />
  <style>
    :root{
      --bg: #0f1223; --card:#151935; --ink:#e9ecff; --muted:#a7b0d9;
      --accent1:#7aa2ff; --accent2:#40e0d0; --accent3:#b388ff;
      --ok:#45d483; --warn:#ffb14e; --shadow:0 10px 26px rgba(0,0,0,.32);
    }
    [data-theme="light"]{
      --bg:#f6f7fb; --card:#ffffff; --ink:#1c2340; --muted:#5b6a9a;
      --accent1:#3b82f6; --accent2:#06b6d4; --accent3:#8b5cf6;
      --ok:#10b981; --warn:#f59e0b; --shadow:0 10px 24px rgba(16,24,40,.08);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans";
      background: radial-gradient(1200px 700px at 80% -10%, rgba(125,106,255,.25), transparent 60%),
                  radial-gradient(800px 500px at -10% 0, rgba(64,224,208,.18), transparent 60%),
                  var(--bg);
      color:var(--ink); padding:24px 16px 80px;
    }
    .shell{max-width:980px; margin:0 auto}

    .header{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; margin-bottom:18px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:40px; height:40px; border-radius:12px; background: conic-gradient(from 180deg, var(--accent1), var(--accent2), var(--accent3), var(--accent1)); box-shadow:0 8px 24px rgba(59,130,246,.35)}
    h1{font-size:clamp(22px,4vw,32px); margin:0}
    .sub{color:var(--muted); font-size:14px; margin-top:2px}

    .tools{display:flex; gap:10px; align-items:center}
    .btn{cursor:pointer; border:0; border-radius:12px; padding:10px 14px; color:#fff; background:linear-gradient(135deg, var(--accent1), var(--accent3)); font-weight:700; box-shadow:var(--shadow); transition:transform .06s ease}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{background:linear-gradient(135deg,#262b52,#1a1e3c)}
    .btn.outline{background:transparent; border:1px solid rgba(255,255,255,.15); color:var(--ink)}

    .tabs{display:flex; gap:8px; background:transparent; margin:12px 0 20px}
    .tab{padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.08); cursor:pointer; font-weight:700; color:var(--muted); background:linear-gradient(180deg, rgba(255,255,255,.04), transparent)}
    .tab.active{color:var(--ink); border-color:transparent; background:var(--card); box-shadow:var(--shadow)}

    .panel{background:var(--card); border-radius:18px; padding:16px; box-shadow:var(--shadow)}
    .panel h3{margin:0 0 8px; font-size:16px}
    .panel p{margin:6px 0 0; color:var(--muted); font-size:14px}

    .summary{display:grid; grid-template-columns:1.3fr .7fr; gap:16px; margin-bottom:22px}
    @media (max-width:760px){.summary{grid-template-columns:1fr}}
    .progress-wrap{display:flex; align-items:center; gap:16px}
    .bar{height:14px; background:#232953; border-radius:999px; overflow:hidden; flex:1}
    .bar .fill{height:100%; width:0; background:linear-gradient(90deg, var(--accent2), var(--accent1)); transition:width .35s ease}
    .stat{min-width:88px; text-align:right; font-weight:800}

    .kpis{display:grid; grid-template-columns:repeat(3,1fr); gap:12px}
    .kpi{background:linear-gradient(180deg, rgba(255,255,255,.04), transparent); border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:14px; text-align:center}
    .kpi .num{font-size:22px; font-weight:800}
    .kpi .lbl{color:var(--muted); font-size:12px}

    .days{display:grid; grid-template-columns:repeat(2,1fr); gap:16px}
    @media (max-width:900px){.days{grid-template-columns:1fr}}
    .day{background:var(--card); border-radius:18px; padding:14px 14px 16px; box-shadow:var(--shadow); position:relative; overflow:hidden}
    .day::before{content:""; position:absolute; inset:auto auto 0 0; width:55%; height:5px; background:linear-gradient(90deg, var(--accent1), var(--accent2)); border-radius:999px}
    .day-head{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px}
    .title{font-weight:800; font-size:16px}
    .tag{color:var(--muted); font-size:12px}
    .task{display:flex; align-items:center; gap:12px; padding:10px 10px; border-radius:12px; border:1px solid rgba(255,255,255,.06); margin:8px 0; background:linear-gradient(180deg, rgba(255,255,255,.04), transparent)}
    .task.done{opacity:.7}
    .chk{--s:22px; inline-size:var(--s); block-size:var(--s); border-radius:7px; border:2px solid #3a457a; display:grid; place-items:center; cursor:pointer; position:relative; flex:0 0 var(--s); background:#111634}
    .chk input{appearance:none; position:absolute; inset:0; margin:0; cursor:pointer}
    .mark{transform:scale(0); transition:transform .18s ease}
    .chk input:checked + .mark{transform:scale(1)}
    .mark svg{width:16px; height:16px; fill:var(--ok)}
    .ttext{flex:1}
    .ttext .name{font-weight:600}
    .ttext .hint{font-size:12px; color:var(--muted)}
    .mini-bar{height:10px; background:#232953; border-radius:999px; overflow:hidden; margin-top:8px}
    .mini-bar .fill{height:100%; width:0; background:linear-gradient(90deg, var(--accent3), var(--accent2)); transition:width .35s ease}

    .row{display:flex; gap:10px; flex-wrap:wrap}
    .field{flex:1; min-width:160px}
    label{display:block; font-size:12px; color:var(--muted); margin:6px 2px}
    input[type="text"], textarea, input[type="date"]{width:100%; background:#0f1438; color:var(--ink); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px 12px}
    [data-theme="light"] input[type="text"], [data-theme="light"] textarea, [data-theme="light"] input[type="date"]{background:#f2f4fb; color:#1c2340; border:1px solid rgba(0,0,0,.08)}
    textarea{min-height:84px; resize:vertical}
    .list{margin-top:14px; display:grid; gap:10px}
    .card{padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.08); background:linear-gradient(180deg, rgba(255,255,255,.04), transparent)}
    .card h4{margin:0 0 6px}
    .pill{display:inline-block; font-size:11px; padding:4px 8px; border-radius:999px; background:#1a2047; color:#b8c2ff; margin-right:6px}
    [data-theme="light"] .pill{background:#e9eeff; color:#36457a}
    .ops{display:flex; gap:8px}
    .ghost{background:transparent; border:1px solid rgba(255,255,255,.15); color:var(--ink); border-radius:10px; padding:6px 10px; cursor:pointer}

    .toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%) translateY(20px); opacity:0; background:rgba(17,24,39,.9); color:#fff; padding:10px 14px; border-radius:10px; box-shadow:var(--shadow); transition: all .25s ease; z-index:30}
    .toast.show{opacity:1; transform:translateX(-50%) translateY(0)}
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.4); z-index:50}
    .modal.active{display:grid}
    .modal-card{background:var(--card); padding:24px 20px; border-radius:18px; text-align:center; width:min(420px, 92vw); box-shadow:var(--shadow)}
    .pop{font-size:38px; margin:0 0 6px}
    #fx{position:fixed; inset:0; pointer-events:none; z-index:60}

    .foot{display:flex; gap:8px; align-items:center; justify-content:space-between; margin-top:18px; color:var(--muted); font-size:12px}
  </style>
</head>
<body data-theme="dark">
  <canvas id="fx"></canvas>
  <div class="shell">
    <div class="header">
      <div class="brand">
        <div class="logo" aria-hidden></div>
        <div>
          <h1>English Level Up</h1>
          <div class="sub">‡πÄ‡∏ä‡πá‡∏Å‡∏ù‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô + ‡∏à‡∏î‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ ‚Äî ‡∏ò‡∏µ‡∏°‡πÄ‡∏î‡∏¥‡∏° ‡∏™‡∏ß‡∏¢‡∏°‡∏¥‡∏ô‡∏¥‡∏°‡∏≠‡∏• üí™üìö</div>
        </div>
      </div>
      <div class="tools">
        <button class="btn secondary" id="themeBtn" title="Toggle theme">üåó Theme</button>
        <button class="btn outline" id="resetBtn" title="‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ">‚ôªÔ∏è Reset Week</button>
        <button class="btn" id="installBtn" title="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ (PWA)">üì≤ Install</button>
      </div>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="checklist">‚úÖ Checklist</button>
      <button class="tab" data-tab="vocab">üìù Vocab Journal</button>
    </div>

    <section id="page-checklist">
      <div class="summary">
        <div class="panel">
          <h3>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</h3>
          <div class="progress-wrap">
            <div class="bar"><div class="fill" id="weekFill"></div></div>
            <div class="stat" id="weekStat">0/0</div>
          </div>
          <p id="weekLabel"></p>
          <div class="kpis" style="margin-top:10px">
            <div class="kpi"><div class="num" id="lvl">Lv. 0</div><div class="lbl">‡πÄ‡∏•‡πÄ‡∏ß‡∏• (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö)</div></div>
            <div class="kpi"><div class="num" id="streak">0 üî•</div><div class="lbl">‡∏™‡∏ï‡∏£‡∏µ‡∏Ñ (‡∏ß‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô)</div></div>
            <div class="kpi"><div class="num" id="todayProg">0%</div><div class="lbl">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div></div>
          </div>
        </div>
        <div class="panel">
          <h3>‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå: <span id="weekKey"></span></h3>
          <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡πá‡∏Å‡∏ö‡πá‡∏≠‡∏Å‡∏ã‡πå‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö ISO week ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà</p>
          <p style="margin-top:8px">‡∏ï‡∏¥‡πä‡∏Å‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô = "Level Up" ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏ï‡∏ï‡∏µ‡πâ üéâ</p>
        </div>
      </div>
      <div class="days" id="days"></div>
    </section>

    <section id="page-vocab" style="display:none">
      <div class="panel" style="margin-bottom:16px">
        <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ</h3>
        <div class="row">
          <div class="field"><label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" id="vcDate"></div>
          <div class="field"><label>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (Word)</label><input type="text" id="vcWord" placeholder="‡πÄ‡∏ä‡πà‡∏ô bulk, consistent, sprint"></div>
          <div class="field"><label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ (Meaning)</label><input type="text" id="vcMeaning" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å, ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠"></div>
        </div>
        <div class="row" style="margin-top:8px">
          <div class="field" style="flex:1 1 100%">
            <label>‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Example Sentence)</label>
            <textarea id="vcExample" placeholder="Write a short example sentence using the word..."></textarea>
          </div>
        </div>
        <div class="row" style="margin-top:10px; justify-content:flex-end">
          <button class="btn" id="addVocab">‚ûï Add</button>
        </div>
      </div>

      <div class="panel">
        <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ <span id="vcCount" class="pill">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span></h3>
        <div class="row" style="margin:6px 0 10px; align-items:center">
          <button class="ghost" id="prevDay">‚óÄ</button>
          <input type="date" id="listDate" class="field" style="max-width:200px">
          <button class="ghost" id="nextDay">‚ñ∂</button>
          <div style="flex:1"></div>
          <button class="ghost" id="clearDay">üóë ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô</button>
        </div>
        <div id="vcList" class="list"></div>
      </div>
    </section>

    <div class="foot">
      <div>‡∏ó‡∏≥‡∏î‡πâ‡∏ß‡∏¢ ‚ô• ‡πÄ‡∏û‡∏∑‡πà‡∏≠ 86 ‚Äî ‡πÇ‡∏´‡∏°‡∏î <span id="modeTxt">Dark</span></div>
      <div>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (localStorage) ‚Äî ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏õ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ</div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>
  <div class="modal" id="modal"><div class="modal-card"><div class="pop">üéâ</div><h2>Level Up!</h2><p id="modalMsg">‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p><div style="margin-top:14px"><button class="btn" id="closeModal">‡∏õ‡∏¥‡∏î</button></div></div></div>

  <script>
    const themeKey = 'englvl_theme';
    const vcKey = (date) => `englvl_vocab_${date}`;
    const getISOWeek = (d = new Date()) => {
      const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      const dayNum = (date.getUTCDay()+6)%7; date.setUTCDate(date.getUTCDate()-dayNum+3);
      const firstThu = new Date(Date.UTC(date.getUTCFullYear(),0,4));
      const week = 1 + Math.round(((date-firstThu)/86400000 - 3 + ((firstThu.getUTCDay()+6)%7))/7);
      return `${date.getUTCFullYear()}-W${String(week).padStart(2,'0')}`;
    };
    const weekKey = () => `englvl_${getISOWeek()}`;
    const read = () => JSON.parse(localStorage.getItem(weekKey())||'{}');
    const write = (o) => localStorage.setItem(weekKey(), JSON.stringify(o));

    const tabs = document.querySelectorAll('.tab');
    const pages = { checklist: document.getElementById('page-checklist'), vocab: document.getElementById('page-vocab') };
    tabs.forEach(t=> t.addEventListener('click', ()=>{
      tabs.forEach(x=>x.classList.remove('active')); t.classList.add('active');
      const id = t.dataset.tab; Object.entries(pages).forEach(([k,el])=> el.style.display = (k===id)?'block':'none');
    }));

    const DAYS = [
      { title:"‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‚Äì Listening", tag:"‡∏ü‡∏±‡∏á & Shadowing", tasks:[
        {name:"‡∏ü‡∏±‡∏á Podcast/YouTube 15 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏à‡∏∞‡∏à‡∏≥‡∏á‡πà‡∏≤‡∏¢"},
        {name:"‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏£‡∏∏‡∏õ 3‚Äì5 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ", hint:"‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏•‡πâ‡∏ß‡∏ô"},
        {name:"‡πÄ‡∏•‡∏µ‡∏¢‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ 5 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 3‚Äì5 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ"},
      ]},
      { title:"‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£ ‚Äì Reading", tag:"‡∏≠‡πà‡∏≤‡∏ô & ‡∏à‡∏î‡∏®‡∏±‡∏û‡∏ó‡πå", tasks:[
        {name:"‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ç‡πà‡∏≤‡∏ß 1 ‡∏ä‡∏¥‡πâ‡∏ô", hint:"5‚Äì10 ‡∏ô‡∏≤‡∏ó‡∏µ"},
        {name:"‡∏à‡∏î‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏´‡∏°‡πà 3‚Äì5 ‡∏Ñ‡∏≥", hint:"‡∏û‡∏£‡πâ‡∏≠‡∏° part of speech"},
        {name:"‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÉ‡∏ä‡πâ‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏´‡∏°‡πà", hint:"‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ"},
      ]},
      { title:"‡∏û‡∏∏‡∏ò ‚Äì Writing", tag:"‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Journal", tasks:[
        {name:"‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Journal 5‚Äì10 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", hint:"‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ"},
        {name:"‡πÄ‡∏ä‡πá‡∏Å‡πÅ‡∏Å‡∏£‡∏°‡∏°‡∏≤‡∏£‡πå‡∏î‡πâ‡∏ß‡∏¢ AI/Grammarly", hint:"‡∏î‡∏π‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ"},
        {name:"‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á", hint:"1‚Äì2 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ"},
      ]},
      { title:"‡∏û‡∏§‡∏´‡∏±‡∏™ ‚Äì Speaking", tag:"‡∏û‡∏π‡∏î & ‡∏≠‡∏±‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á", tasks:[
        {name:"‡∏≠‡∏±‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á 3‚Äì5 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏≠‡∏¥‡∏™‡∏£‡∏∞"},
        {name:"‡∏ü‡∏±‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á + ‡∏à‡∏î‡∏à‡∏∏‡∏î‡∏ï‡∏¥‡∏î‡∏Ç‡∏±‡∏î", hint:"‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞"},
        {name:"‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô/‡πÅ‡∏•‡∏Å‡∏†‡∏≤‡∏©‡∏≤ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ)", hint:"15 ‡∏ô‡∏≤‡∏ó‡∏µ"},
      ]},
      { title:"‡∏®‡∏∏‡∏Å‡∏£‡πå ‚Äì Mixed", tag:"‡∏ú‡∏™‡∏°‡∏Ñ‡∏£‡∏ö 4 ‡∏ó‡∏±‡∏Å‡∏©‡∏∞", tasks:[
        {name:"‡∏ü‡∏±‡∏á Podcast 5 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡πâ‡∏ô ‡πÜ"},
        {name:"‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô 1 ‡∏ä‡∏¥‡πâ‡∏ô", hint:"‡∏Ç‡πà‡∏≤‡∏ß/‡∏ö‡∏•‡πá‡∏≠‡∏Å"},
        {name:"‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô summary 3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î", hint:"‡πÅ‡∏•‡∏∞‡∏û‡∏π‡∏î‡∏™‡∏£‡∏∏‡∏õ 1 ‡∏ô‡∏≤‡∏ó‡∏µ"},
      ]},
      { title:"‡πÄ‡∏™‡∏≤‡∏£‡πå ‚Äì Vocabulary", tag:"‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏®‡∏±‡∏û‡∏ó‡πå", tasks:[
        {name:"‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå", hint:"‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏°‡∏∏‡∏î/‡πÅ‡∏≠‡∏õ"},
        {name:"‡πÄ‡∏•‡πà‡∏ô flashcards 10‚Äì15 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"Anki/Quizlet"},
        {name:"‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏Å‡πà‡∏≤", hint:"‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ"},
      ]},
      { title:"‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå ‚Äì Review & Fun", tag:"‡∏î‡∏π-‡πÄ‡∏û‡∏•‡∏¥‡∏ô-‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ", tasks:[
        {name:"‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå/YouTube 30‚Äì60 ‡∏ô‡∏≤‡∏ó‡∏µ", hint:"‡πÄ‡∏õ‡∏¥‡∏î‡∏ã‡∏±‡∏ö‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
        {name:"‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ", hint:"‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏™‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏´‡∏°‡πà"},
        {name:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏®‡∏±‡∏û‡∏ó‡πå/‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÄ‡∏î‡πá‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå", hint:"Top picks"},
      ]},
    ];

    const daysEl = document.getElementById('days');
    function build(){
      daysEl.innerHTML = '';
      DAYS.forEach((day, di)=>{
        const card = document.createElement('section'); card.className='day'; card.dataset.di = di;
        card.innerHTML = `
          <div class="day-head">
            <div><div class="title">${day.title}</div><div class="tag">${day.tag}</div></div>
            <div class="tag"><span id="count-${di}">0/0</span></div>
          </div>
          <div class="tasks"></div>
          <div class="mini-bar" aria-hidden><div class="fill" id="fill-${di}"></div></div>
        `;
        const wrap = card.querySelector('.tasks');
        day.tasks.forEach((t, ti)=>{
          const row = document.createElement('div'); row.className='task';
          row.innerHTML = `
            <label class="chk">
              <input type="checkbox" data-di="${di}" data-ti="${ti}" />
              <span class="mark"><svg viewBox="0 0 24 24"><path d="M20.285 6.709a1 1 0 0 0-1.414-1.414l-9.192 9.192-4.243-4.243a1 1 0 1 0-1.414 1.414l5 5a1 1 0 0 0 1.414 0l10.85-10.85z"/></svg></span>
            </label>
            <div class="ttext"><div class="name">${t.name}</div><div class="hint">${t.hint||''}</div></div>`;
          wrap.appendChild(row);
        });
        daysEl.appendChild(card);
      });
    }

    function loadState(){
      const s = read();
      document.querySelectorAll('input[type=checkbox]').forEach(cb=>{
        const di = cb.dataset.di, ti = cb.dataset.ti; const val = s?.[di]?.[ti] ?? false;
        cb.checked = !!val; if (val) cb.closest('.task').classList.add('done');
      });
      refreshAll();
    }
    function saveTick(di, ti, val){ const s = read(); s[di] = s[di] || {}; s[di][ti] = val; write(s); }

    function refreshAll(){
      DAYS.forEach((_, di)=>{
        const tasks = document.querySelectorAll(`input[data-di="${di}"]`);
        const done = [...tasks].filter(x=>x.checked).length; const total = tasks.length;
        const pct = Math.round((done/total)*100); const bar = document.getElementById(`fill-${di}`); const ct = document.getElementById(`count-${di}`);
        if (bar) bar.style.width = pct+'%'; if (ct) ct.textContent = `${done}/${total}`;
        tasks.forEach(x=> x.closest('.task').classList.toggle('done', x.checked));
      });
      const all = document.querySelectorAll('input[type=checkbox]');
      const doneAll = [...all].filter(x=>x.checked).length; const totalAll = all.length;
      document.getElementById('weekFill').style.width = (doneAll/totalAll*100)+'%';
      document.getElementById('weekStat').textContent = `${doneAll}/${totalAll}`;
      document.getElementById('weekLabel').textContent = `‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß ${Math.round(doneAll/totalAll*100)}% ‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ`;
      let levels=0, todayPct=0; DAYS.forEach((_, di)=>{ const t = document.querySelectorAll(`input[data-di="${di}"]`); const d=[...t].filter(x=>x.checked).length; const tot=t.length; if (d===tot) levels++; if (isTodayIndex(di)) todayPct = Math.round((d/tot)*100); });
      document.getElementById('lvl').textContent = `Lv. ${levels}`;
      document.getElementById('todayProg').textContent = `${todayPct}%`;
      document.getElementById('streak').textContent = `${calcStreak()} üî•`;
    }
    function isTodayIndex(di){ const dow=(new Date().getDay()+6)%7; return di===dow; }
    function dayCompleted(di){ const t = document.querySelectorAll(`input[data-di="${di}"]`); return [...t].every(x=>x.checked); }
    function calcStreak(){ const today=(new Date().getDay()+6)%7; let c=0; for(let i=today;i>=0;i--){ if (dayCompleted(i)) c++; else break; } return c; }

    const modal = document.getElementById('modal'); const modalMsg = document.getElementById('modalMsg');
    function showLevelUp(di){ const name = DAYS[di].title.split('‚Äì')[0].trim(); modalMsg.textContent = `‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏ß‡∏±‡∏ô${name} ‡πÅ‡∏•‡πâ‡∏ß`; modal.classList.add('active'); confettiBurst(); }
    document.getElementById('closeModal').addEventListener('click', ()=> modal.classList.remove('active'));
    modal.addEventListener('click', (e)=>{ if (e.target===modal) modal.classList.remove('active'); });
    function confettiBurst(){ const c=document.getElementById('fx'); const ctx=c.getContext('2d'); const W=c.width=innerWidth, H=c.height=innerHeight; const N=160; const parts=Array.from({length:N},()=>({x:Math.random()*W,y:-20,r:2+Math.random()*4,vx:-2+Math.random()*4,vy:2+Math.random()*3,a:Math.random()*Math.PI,s:.96+.02*Math.random()})); let t=0, req; const palette=['#7aa2ff','#40e0d0','#b388ff','#f59e0b','#10b981']; function step(){ ctx.clearRect(0,0,W,H); parts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.vy+=0.03; p.a+=0.05; p.vx*=p.s; p.vy*=p.s; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.a); ctx.fillStyle=palette[(p.r|0)%palette.length]; ctx.fillRect(-p.r,-p.r,p.r*2,p.r*2); ctx.restore(); }); if(t++<120) req=requestAnimationFrame(step); else cancelAnimationFrame(req);} step(); setTimeout(()=>{const ctx2=c.getContext('2d'); ctx2.clearRect(0,0,W,H);},2400); }

    function attach(){
      document.querySelectorAll('input[type=checkbox]').forEach(cb=>{
        cb.addEventListener('change', ()=>{ const di=+cb.dataset.di, ti=+cb.dataset.ti; saveTick(di, ti, cb.checked); refreshAll(); if (dayCompleted(di)) showLevelUp(di); });
      });
    }

    document.getElementById('resetBtn').addEventListener('click', ()=>{ if (confirm('‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏¥‡πä‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ?')){ localStorage.removeItem(weekKey()); document.querySelectorAll('input[type=checkbox]').forEach(cb=> cb.checked=false); refreshAll(); } });
    const body=document.body; function setTheme(t){ body.setAttribute('data-theme', t); localStorage.setItem(themeKey, t); document.getElementById('modeTxt').textContent = t==='light'?'Light':'Dark'; }
    document.getElementById('themeBtn').addEventListener('click', ()=> setTheme(body.getAttribute('data-theme')==='light'?'dark':'light'));

    document.getElementById('weekKey').textContent = getISOWeek();

    build(); attach(); loadState(); const pref = localStorage.getItem(themeKey)||'dark'; setTheme(pref); refreshAll();

    const vcDate = document.getElementById('vcDate'); const vcWord = document.getElementById('vcWord'); const vcMeaning = document.getElementById('vcMeaning'); const vcExample = document.getElementById('vcExample'); const addVocabBtn = document.getElementById('addVocab'); const vcList = document.getElementById('vcList'); const vcCount = document.getElementById('vcCount'); const listDate = document.getElementById('listDate'); const prevDay = document.getElementById('prevDay'); const nextDay = document.getElementById('nextDay'); const clearDay = document.getElementById('clearDay');

    function fmt(d){ return d.toISOString().slice(0,10); }
    function setToday(){ const t = new Date(); const s = fmt(t); vcDate.value = s; listDate.value = s; renderList(); }
    function saveVocab(date, item){ const key = vcKey(date); const arr = JSON.parse(localStorage.getItem(key)||'[]'); arr.push({...item, id: Date.now()}); localStorage.setItem(key, JSON.stringify(arr)); showToast('Saved ‚úî'); renderList(); }
    function loadVocab(date){ return JSON.parse(localStorage.getItem(vcKey(date))||'[]'); }
    function updateVocab(date, id, patch){ const arr = loadVocab(date).map(x=> x.id===id? {...x, ...patch}:x); localStorage.setItem(vcKey(date), JSON.stringify(arr)); renderList(); }
    function deleteVocab(date, id){ const arr = loadVocab(date).filter(x=> x.id!==id); localStorage.setItem(vcKey(date), JSON.stringify(arr)); renderList(); }
    function renderList(){ const d=listDate.value; const data = loadVocab(d); vcList.innerHTML=''; vcCount.textContent = `${data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`; if (!data.length){ vcList.innerHTML = '<div class="tag">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>'; return; }
      data.forEach(item=>{ const el=document.createElement('div'); el.className='card'; el.innerHTML = `
        <h4>${item.word} <span class="pill">${item.meaning||''}</span></h4>
        <div style="font-size:13px; color:var(--muted); margin-bottom:8px">${new Date(item.ts).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>
        <div style="white-space:pre-wrap">${item.example||''}</div>
        <div class="ops" style="margin-top:10px">
          <button class="ghost" data-op="edit">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button class="ghost" data-op="del">üóë ‡∏•‡∏ö</button>
        </div>`;
        el.querySelector('[data-op="edit"]').addEventListener('click', ()=>{
          const w = prompt('‡πÅ‡∏Å‡πâ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå', item.word); if (w===null) return; const m=prompt('‡πÅ‡∏Å‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢', item.meaning||''); if (m===null) return; const ex=prompt('‡πÅ‡∏Å‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á', item.example||''); if (ex===null) return; updateVocab(d, item.id, {word:w, meaning:m, example:ex});
        });
        el.querySelector('[data-op="del"]').addEventListener('click', ()=>{ if (confirm('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) deleteVocab(d, item.id); });
        vcList.appendChild(el);
      });
    }
    addVocabBtn.addEventListener('click', ()=>{
      const date = vcDate.value || fmt(new Date()); const word = vcWord.value.trim(); if (!word) return alert('‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≤');
      saveVocab(date, {word, meaning: vcMeaning.value.trim(), example: vcExample.value.trim(), ts: Date.now()});
      vcWord.value=''; vcMeaning.value=''; vcExample.value=''; listDate.value = date; renderList();
    });
    listDate.addEventListener('change', renderList);
    function shiftDay(delta){ const d = new Date(listDate.value); d.setDate(d.getDate()+delta); listDate.value = fmt(d); renderList(); }
    prevDay.addEventListener('click', ()=> shiftDay(-1)); nextDay.addEventListener('click', ()=> shiftDay(1));
    clearDay.addEventListener('click', ()=>{ const d=listDate.value; if (confirm('‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ?')){ localStorage.removeItem(vcKey(d)); renderList(); }});
    function showToast(msg){ const t=document.getElementById('toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=> t.classList.remove('show'), 1400); }

    setToday();

    // ---- PWA (relative paths for GitHub Pages project) ----
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
    let deferredPrompt; const installBtn = document.getElementById('installBtn');
    installBtn.style.display = 'none';
    window.addEventListener('beforeinstallprompt', (e)=>{
      e.preventDefault(); deferredPrompt = e; installBtn.style.display='inline-block';
    });
    installBtn.addEventListener('click', async ()=>{
      if (!deferredPrompt) { alert('‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏° ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π ‚ãÆ > Add to Home screen'); return; }
      deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt = null;
    });
  </script>
</body>
</html>
